import{d as Q,bf as W,bx as U,bD as ne,bz as oe,ba as i,o as X,c as le,w as o,f as e,bs as v,bA as g,e as n,dq as M,ds as se,bg as P,eG as ue,ew as ie,q as re,b8 as z,bC as pe,bJ as V}from"./.pnpm-ce7dda7b.js";import{u as de,a8 as me,a9 as fe,_ as ce}from"./index-b6608134.js";import{i as ve}from"./icon-7d63310d.js";import{S as m,t as N}from"./index-54633a7f.js";import{a as j,b as J,c as x}from"./deviceApi-ee3669b6.js";import{u as Y}from"./useTargetData.hook-ac6d967b.js";import{b as K,d as ge}from"./index-ce999aec.js";import{C as he}from"./index-f2232116.js";import"./chartEditStore-0a96ea37.js";import"./plugin-744af617.js";import"./settingStore-07be61e1.js";import"./index-18fcb4c8.js";import"./index.vue_vue_type_script_setup_true_lang-b36c4261.js";import"./file-6db2fad1.js";const be=Q({__name:"index",props:{modelShow:Boolean},emits:["update:modelShow","sendHandle"],setup(E,{emit:q}){const R=E,{targetData:t,chartEditStore:d}=Y(),{requestOriginUrl:p,requestInterval:D,requestIntervalUnit:f,range:w,timeRange:B}=W(d.getRequestGlobalConfig),h=U(!1),r=ne({deviceOptions:[],ithingOptions:[],moduleOptions:[],propertyOptions:[]});let I=t.value.request.apphubData.ithingId,S=t.value.request.apphubData.module,$=t.value.request.apphubData.propertys,b=t.value.request.apphubData.type,l=t.value.request.apphubData.funcId;const c=()=>{j(p.value).then(a=>{a.code==200&&Array.isArray(a.data)&&(r.ithingOptions=a.data)})},C=(a,s)=>{t.value.request.apphubData.ithingName=s.label,t.value.request.apphubData.module="",t.value.request.apphubData.propertys=[],t.value.request.apphubData.funcId="",J(p.value,a).then(y=>{y.code==200&&Array.isArray(y.data)&&(r.moduleOptions=y.data)})},A=a=>{t.value.request.apphubData.propertys=[],t.value.request.apphubData.funcId="",x(p.value,t.value.request.apphubData.ithingId,a).then(s=>{s.code==200&&Array.isArray(s.data)&&(r.propertyOptions=s.data)})},H=a=>{t.value.request.apphubData.funcId=""},O=()=>{j(p.value).then(a=>{a.code==200&&Array.isArray(a.data)&&(r.ithingOptions=a.data)}),t.value.request.apphubData.ithingId!=""&&(J(p.value,t.value.request.apphubData.ithingId).then(a=>{a.code==200&&Array.isArray(a.data)&&(r.moduleOptions=a.data)}),t.value.request.apphubData.module!=""&&x(p.value,t.value.request.apphubData.ithingId,t.value.request.apphubData.module).then(a=>{a.code==200&&Array.isArray(a.data)&&(r.propertyOptions=a.data)}))};c(),O(),oe(()=>R.modelShow,a=>{h.value=a});const k=()=>{q("update:modelShow",!1),q("sendHandle"),I=t.value.request.apphubData.ithingId,S=t.value.request.apphubData.module,$=t.value.request.apphubData.propertys,b=t.value.request.apphubData.type,l=t.value.request.apphubData.funcId},T=()=>{q("update:modelShow",!1),t.value.request.apphubData.ithingId=I,t.value.request.apphubData.module=S,t.value.request.apphubData.propertys=$,t.value.request.apphubData.type=b,t.value.request.apphubData.funcId=l};return(a,s)=>{const y=i("n-tag"),Z=i("n-input"),F=i("n-input-number"),_=i("n-select"),G=i("n-input-group"),L=i("n-button"),ee=i("n-space"),te=i("n-card"),ae=i("n-modal");return X(),le(ae,{class:"go-chart-data-pond-control",show:h.value,"onUpdate:show":s[9]||(s[9]=u=>h.value=u),"mask-closable":!1},{default:o(()=>[e(te,{bordered:!1,role:"dialog",size:"small","aria-modal":"true",style:{width:"900px",height:"800px"}},{action:o(()=>[e(ee,{justify:"end"},{default:o(()=>[e(L,{type:"info",onClick:T},{default:o(()=>[v(g(a.$t("editConfig.cancel")),1)]),_:1}),e(L,{type:"primary",onClick:k},{default:o(()=>[v(g(a.$t("editConfig.save")),1)]),_:1})]),_:1})]),default:o(()=>[e(y,{type:"info",bordered:!1,style:{"border-radius":"5px"}},{default:o(()=>[v(g(a.$t("editConfig.globalPublicConfig")),1)]),_:1}),e(n(m),{name:a.$t("editConfig.serverAddress"),itemRightStyle:{gridTemplateColumns:"5fr 2fr 1fr"}},{default:o(()=>[e(n(N),{name:a.$t("editConfig.frontUrl")},{default:o(()=>[e(Z,{value:n(p),"onUpdate:value":s[0]||(s[0]=u=>M(p)?p.value=u:null),valueModifiers:{trim:!0},placeholder:"http://127.0.0.1:8082/",onBlur:c},null,8,["value"])]),_:1},8,["name"]),e(n(N),{name:a.$t("editConfig.intervalDescription")},{default:o(()=>[e(G,null,{default:o(()=>[e(F,{class:"select-time-number",value:n(D),"onUpdate:value":s[1]||(s[1]=u=>M(D)?D.value=u:null),valueModifiers:{trim:!0},min:"0","show-button":!1,placeholder:a.$t("editConfig.requestIntervalPlaceholder")},null,8,["value","placeholder"]),e(_,{class:"select-time-options",value:n(f),"onUpdate:value":s[2]||(s[2]=u=>M(f)?f.value=u:null),options:n(K)},null,8,["value","options"])]),_:1})]),_:1},8,["name"])]),_:1},8,["name"]),e(y,{type:"info",bordered:!1,style:{"border-radius":"5px"}},{default:o(()=>[v(g(a.$t("editConfig.AppHubConfig")),1)]),_:1}),e(n(m),{name:a.$t("editConfig.subDevice"),itemRightStyle:{gridTemplateColumns:"5fr 1fr"},itemLeftStyle:{width:"80px"}},{default:o(()=>[e(_,{class:"select-time-options",value:n(t).request.apphubData.ithingId,"onUpdate:value":[s[3]||(s[3]=u=>n(t).request.apphubData.ithingId=u),C],options:r.ithingOptions},null,8,["value","options"])]),_:1},8,["name"]),e(n(m),{name:a.$t("editConfig.module"),itemRightStyle:{gridTemplateColumns:"5fr 1fr"},itemLeftStyle:{width:"80px"}},{default:o(()=>[e(_,{class:"select-time-options",value:n(t).request.apphubData.module,"onUpdate:value":[s[4]||(s[4]=u=>n(t).request.apphubData.module=u),A],options:r.moduleOptions},null,8,["value","options"])]),_:1},8,["name"]),e(n(m),{name:a.$t("editConfig.property"),itemRightStyle:{gridTemplateColumns:"5fr 1fr"},itemLeftStyle:{width:"80px"}},{default:o(()=>[e(_,{class:"select-time-options",value:n(t).request.apphubData.propertys,"onUpdate:value":[s[5]||(s[5]=u=>n(t).request.apphubData.propertys=u),H],multiple:"",options:r.propertyOptions},null,8,["value","options"])]),_:1},8,["name"]),e(n(m),{name:a.$t("editConfig.type"),itemRightStyle:{gridTemplateColumns:"5fr 1fr"},itemLeftStyle:{width:"80px"}},{default:o(()=>[e(_,{class:"select-time-options",value:n(t).request.apphubData.type,"onUpdate:value":s[6]||(s[6]=u=>n(t).request.apphubData.type=u),options:n(ge)},null,8,["value","options"])]),_:1},8,["name"]),e(n(m),{name:a.$t("editConfig.interval"),itemRightStyle:{gridTemplateColumns:"5fr 1fr"},itemLeftStyle:{width:"80px"}},{default:o(()=>[e(n(N),{name:a.$t("editConfig.intervalDescription")},{default:o(()=>[e(G,null,{default:o(()=>[e(F,{value:n(t).request.requestInterval,"onUpdate:value":s[7]||(s[7]=u=>n(t).request.requestInterval=u),valueModifiers:{trim:!0},class:"select-time-number",min:"0","show-button":!1,placeholder:a.$t("editConfig.requestIntervalPlaceholder1")},null,8,["value","placeholder"]),e(_,{class:"select-time-options",value:n(t).request.requestIntervalUnit,"onUpdate:value":s[8]||(s[8]=u=>n(t).request.requestIntervalUnit=u),options:n(K)},null,8,["value","options"])]),_:1})]),_:1},8,["name"])]),_:1},8,["name"])]),_:1})]),_:1},8,["show"])}}}),ye={class:"go-chart-data-pond"},_e={class:"go-absolute-center"},qe=Q({__name:"index",setup(E){se(l=>({"1aef590a":n(S)}));const q=de(),{HelpOutlineIcon:R,FlashIcon:t}=ve.ionicons5,{targetData:d,chartEditStore:p}=Y(),{requestOriginUrl:D}=W(p.getRequestGlobalConfig),f=U(!1),w=U(!1),B=U(!1);let h=0,r;const I=P(()=>{var l="";for(let c of d.value.request.apphubData.propertys)l==""?l=c:l=l+"&&"+c;return l}),S=P(()=>q.getAppTheme),$=()=>{w.value=!0},b=async()=>{if(!d.value?.request){window.$message.warning("请选择一个公共接口！");return}f.value=!0;try{const l=await me(V(d.value.request),V(p.getRequestGlobalConfig));if(f.value=!1,l){!l?.data&&!d.value.filter&&window.$message.warning("您的数据不符合默认格式，请配置过滤器！"),d.value.option.dataset=fe(l?.data,l,d.value.filter),B.value=!0;return}window.$message.warning("数据异常，请检查参数！")}catch{f.value=!1,window.$message.warning("数据异常，请检查参数！")}};return ue(()=>{const l=d.value?.filter;r!==l&&h&&(r=l,b()),h++}),ie(()=>{r=null}),(l,c)=>{const C=i("n-input"),A=i("n-button"),H=i("n-card"),O=i("n-icon"),k=i("n-tooltip"),T=i("go-skeleton");return X(),re(pe,null,[z("div",ye,[e(H,{class:"n-card-shallow"},{default:o(()=>[e(n(m),{name:l.$t("editConfig.serverAddress"),alone:!0},{default:o(()=>[e(C,{size:"small",placeholder:n(D)||l.$t("editConfig.none"),disabled:!0},null,8,["placeholder"])]),_:1},8,["name"]),e(n(m),{name:l.$t("editConfig.subDevice"),alone:!0},{default:o(()=>[e(C,{size:"small",placeholder:n(d).request.apphubData.ithingName||l.$t("editConfig.none"),disabled:!0},null,8,["placeholder"])]),_:1},8,["name"]),e(n(m),{name:l.$t("editConfig.property"),alone:!0},{default:o(()=>[e(C,{size:"small",placeholder:n(I)||l.$t("editConfig.none"),disabled:!0},null,8,["placeholder"])]),_:1},8,["name"]),z("div",{class:"edit-text",onClick:$},[z("div",_e,[e(A,{type:"primary",secondary:""},{default:o(()=>[v(g(l.$t("editConfig.editConfig")),1)]),_:1})])])]),_:1})]),e(n(m),{alone:!0},{name:o(()=>[v(g(l.$t("editConfig.test"))+" ",1),e(k,{trigger:"hover"},{trigger:o(()=>[e(O,{size:"21",depth:3},{default:o(()=>[e(n(R))]),_:1})]),default:o(()=>[v(" "+g(l.$t("editConfig.tooltip")),1)]),_:1})]),default:o(()=>[e(A,{type:"primary",ghost:"",onClick:b},{icon:o(()=>[e(O,null,{default:o(()=>[e(n(t))]),_:1})]),default:o(()=>[v(" "+g(l.$t("editConfig.sendRequest")),1)]),_:1})]),_:1}),e(n(he),{show:B.value&&!f.value,ajax:!0},null,8,["show"]),e(T,{load:f.value,repeat:3},null,8,["load"]),e(n(be),{modelShow:w.value,"onUpdate:modelShow":c[0]||(c[0]=a=>w.value=a),onSendHandle:b},null,8,["modelShow"])],64)}}});const Me=ce(qe,[["__scopeId","data-v-1d2d3fd7"]]);export{Me as default};
