import{M}from"./index-250e25a0.js";import{_ as N}from"./index-cfc1485a.js";import{u as V,d as b}from"./chartEditStore-0a96ea37.js";import{u as z,a as y}from"./chartLayoutStore-1c1c2b2b.js";import{k as J,f as k,c as v,d as U,r as q,b as G}from"./index-54633a7f.js";import{i as Y,a1 as j,ak as Q,J as W,_ as X}from"./index-b6608134.js";import{d as Z,bx as ee,bg as te,bz as ae,bK as oe,ba as f,o as s,q as d,b8 as g,bC as se,bB as ne,f as o,e as r,w as n,bs as x,bA as E,c as S,eC as ce,bH as w,bL as re,eD as le,bb as ie,bc as de}from"./.pnpm-ce7dda7b.js";import{a as ge,b as pe,l as _e,g as fe}from"./plugin-744af617.js";import{c as u}from"./index-18fcb4c8.js";import{i as ue}from"./icon-7d63310d.js";import"./index-a6ee1110.js";import"./settingStore-07be61e1.js";import"./index.vue_vue_type_script_setup_true_lang-b36c4261.js";const he=l=>(ie("data-v-8a8614c8"),l=l(),de(),l),me={class:"go-content-charts-item-animation-patch"},Ce=["onDragstart","onDragend","onDblclick","onClick"],be={class:"list-header"},ye={class:"list-center go-flex-center go-transition",draggable:"true"},ke={class:"list-bottom"},ve={key:0,class:"list-model"},xe=["onClick"],Ee=he(()=>g("span",null,"删除",-1)),Se=Z({__name:"index",props:{menuOptions:{type:Array,default:()=>[]}},emits:["deletePhoto"],setup(l,{emit:D}){const{t:c}=Y.global,p=V(),{TrashIcon:I}=ue.ionicons5,T=z(),m=ee(),B=e=>!e.disabled&&e.package===j.PHOTOS&&e.category===J.PRIVATE,C=te(()=>T.getChartType),O=(e,t)=>{t.disabled||(u(t.chartKey,k(t)),u(t.conKey,v(t)),e.dataTransfer.setData(Q.DRAG_KEY,W(le(t,["image"]))),p.setEditCanvas(b.IS_CREATE,!0))},A=()=>{p.setEditCanvas(b.IS_CREATE,!1)},H=async e=>{if(!e.disabled)try{ge(),u(e.chartKey,k(e)),u(e.conKey,v(e));let t=await U(e);e.redirectComponent&&(e.dataset&&(t.option.dataset=e.dataset),t.chartConfig.title=e.title,t.chartConfig.chartFrame=e.chartFrame),p.addComponentList(t,!1,!0),p.setTargetSelectChart(t.id),pe()}catch(t){console.error(t),_e(),window.$message.warning("图表正在研发中, 敬请期待...")}},L=e=>{e?.configEvents?.addHandle(e)},P=(e,t)=>{q(e.id).then(async _=>{_.code==200?(G().deletePhotos(e,t),window.$message.success(c("gallery.deleteSuccess"))):window.$message.warning(c("gallery.deleteFailed"))})},$=(e,t)=>{fe({message:c("gallery.deleteMessage"),title:c("gallery.tip"),positiveText:c("gallery.confirm"),negativeText:c("gallery.cancel"),transformOrigin:"center",onPositiveCallback:()=>{D("deletePhoto",e,t),P(e,t)}})};return ae(()=>C.value,e=>{e===y.DOUBLE&&oe(()=>{m.value.classList.add("miniAnimation")})}),(e,t)=>{const _=f("n-ellipsis"),h=f("n-text"),K=f("n-icon"),R=f("n-button");return s(),d("div",me,[g("div",{ref_key:"contentChartsItemBoxRef",ref:m,class:re(["go-content-charts-item-box",[r(C)===r(y).DOUBLE?"double":"single"]])},[(s(!0),d(se,null,ne(l.menuOptions,(a,F)=>(s(),d("div",{class:"item-box",key:a.title,draggable:"",onDragstart:i=>!a.disabled&&O(i,a),onDragend:i=>!a.disabled&&A,onDblclick:i=>H(a),onClick:i=>L(a)},[g("div",be,[o(r(M),{class:"list-header-control-btn",mini:!0,disabled:!0}),o(h,{class:"list-header-text",depth:"3"},{default:n(()=>[o(_,null,{default:n(()=>[x(E(a.title),1)]),_:2},1024)]),_:2},1024)]),g("div",ye,[a.icon?(s(),S(r(ce),{key:0,class:"list-img",icon:a.icon,color:"#999",width:"48"},null,8,["icon"])):(s(),S(r(N),{key:1,class:"list-img",chartConfig:a},null,8,["chartConfig"]))]),g("div",ke,[o(h,{class:"list-bottom-text",depth:"3"},{default:n(()=>[o(_,{style:{"max-width":"90%"}},{default:n(()=>[x(E(a.title),1)]),_:2},1024)]),_:2},1024)]),a.disabled?(s(),d("div",ve)):w("",!0),B(a)?(s(),d("div",{key:1,class:"list-tools go-transition",onClick:i=>$(a,F)},[o(R,{text:"",type:"default",color:"#ffffff"},{icon:n(()=>[o(K,null,{default:n(()=>[o(r(I))]),_:1})]),default:n(()=>[Ee]),_:1})],8,xe)):w("",!0)],40,Ce))),128))],2)])}}});const Fe=X(Se,[["__scopeId","data-v-8a8614c8"]]);export{Fe as default};
