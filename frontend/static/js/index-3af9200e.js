import{d as $,bf as H,bx as S,bz as M,ba as n,o as E,c as Q,w as t,f as e,bs as l,bA as m,b8 as R,e as a,ds as J,bg as P,eG as K,ew as W,q as X,bJ as z}from"./.pnpm-ce7dda7b.js";import{B as T,_ as F,u as Y,ar as B,a8 as Z,a9 as ee}from"./index-b6608134.js";import{i as te}from"./icon-7d63310d.js";import{S as q,t as x}from"./index-54633a7f.js";import{R as ae,a as oe}from"./pondIndex.vue_vue_type_style_index_0_scoped_de860d6d_lang-527b36d4.js";import{u as ne}from"./useTargetData.hook-ac6d967b.js";import"./index-ce999aec.js";import"./EditorWorker-ca19246c.js";import{C as se}from"./index-f2232116.js";import"./chartEditStore-0a96ea37.js";import"./plugin-744af617.js";import"./settingStore-07be61e1.js";import"./index-18fcb4c8.js";import"./index.vue_vue_type_script_setup_true_lang-b36c4261.js";import"./file-6db2fad1.js";const le={class:"go-pr-3"},re=$({__name:"index",props:{modelShow:Boolean,targetData:Object,saveBtnText:String||null},emits:["update:modelShow","sendHandle"],setup(y,{emit:c}){const d=y;H(d.targetData),H(d.targetData.request);const i=S(!1);T.DEFAULT+"",T.SQL+"",M(()=>d.modelShow,u=>{i.value=u},{immediate:!0});const o=()=>{c("update:modelShow",!1)},f=()=>{c("update:modelShow",!1),c("sendHandle")};return(u,h)=>{const g=n("n-space"),C=n("n-scrollbar"),r=n("n-button"),_=n("n-card"),v=n("n-modal");return E(),Q(v,{class:"go-chart-data-request",show:i.value,"onUpdate:show":h[0]||(h[0]=w=>i.value=w),"mask-closable":!1,closeOnEsc:!1},{default:t(()=>[e(_,{bordered:!1,role:"dialog",size:"small","aria-modal":"true",style:{width:"1000px",height:"800px"}},{header:t(()=>[]),"header-extra":t(()=>[]),action:t(()=>[e(g,{justify:"end"},{default:t(()=>[e(r,{type:"info",onClick:o},{default:t(()=>[l(m(u.$t("editConfig.cancel")),1)]),_:1}),e(r,{type:"primary",onClick:f},{default:t(()=>[l(m(u.$t("editConfig.save")),1)]),_:1})]),_:1})]),default:t(()=>[e(C,{style:{"max-height":"718px"}},{default:t(()=>[R("div",le,[e(g,{vertical:""},{default:t(()=>[e(a(ae)),e(a(oe),{"target-data-request":y.targetData?.request},null,8,["target-data-request"])]),_:1})])]),_:1})]),_:1})]),_:1},8,["show"])}}}),de=F(re,[["__scopeId","data-v-71e36e51"]]),ue={class:"go-chart-configurations-data-ajax"},ce={class:"go-absolute-center"},ie=l("编辑配置"),_e=l(" 测试 "),pe=l(" 默认赋值给 dataset 字段 "),me=l(" 发送请求 "),fe=$({__name:"index",setup(y){J(s=>({f4040e60:a(j)}));const{HelpOutlineIcon:c,FlashIcon:d,PulseIcon:i}=te.ionicons5,{targetData:o,chartEditStore:f}=ne(),{requestOriginUrl:u,requestInterval:h,requestIntervalUnit:g}=H(f.getRequestGlobalConfig),C=Y(),r=S(!1),_=S(!1),v=S(!1);let w=0,D;const G=()=>{_.value=!0},I=async()=>{if(o.value?.request){r.value=!0;try{const s=await Z(z(o.value.request),z(f.getRequestGlobalConfig));if(r.value=!1,s){!s?.data&&!o.value.filter&&window.$message.warning("您的数据不符合默认格式，请配置过滤器！"),o.value.option.dataset=ee(s?.data,s,o.value.filter),v.value=!0;return}window.$message.warning("数据异常，请检查参数！")}catch{r.value=!1,window.$message.warning("数据异常，请检查参数！")}}},j=P(()=>C.getAppTheme);return K(()=>{const s=o.value?.filter;D!==s&&w&&(D=s,I()),w++}),W(()=>{D=null}),(s,k)=>{const A=n("n-tag"),p=n("n-input"),b=n("n-icon"),U=n("n-button"),L=n("n-card"),O=n("n-tooltip"),N=n("go-skeleton");return E(),X("div",ue,[e(L,{class:"n-card-shallow"},{default:t(()=>[e(a(q),{name:"请求配置"},{default:t(()=>[e(a(x),{name:"类型"},{default:t(()=>[e(A,{bordered:!1,type:"primary",style:{"border-radius":"5px"}},{default:t(()=>[l(m(a(o).request.requestContentType===a(T).DEFAULT?"普通请求":"SQL请求"),1)]),_:1})]),_:1}),e(a(x),{name:"方式"},{default:t(()=>[e(p,{size:"small",placeholder:a(o).request.requestHttpType||"暂无",disabled:!0},null,8,["placeholder"])]),_:1}),e(a(x),{name:"组件间隔"},{default:t(()=>[e(p,{size:"small",placeholder:`${a(o).request.requestInterval||"暂无"}`,disabled:!0},{suffix:t(()=>[l(m(a(B)[a(o).request.requestIntervalUnit]),1)]),_:1},8,["placeholder"])]),_:1}),e(a(x),{name:"全局间隔（默认）"},{default:t(()=>[e(p,{size:"small",placeholder:`${a(h)||"暂无"} `,disabled:!0},{suffix:t(()=>[l(m(a(B)[a(g)]),1)]),_:1},8,["placeholder"])]),_:1})]),_:1}),e(a(q),{name:"源地址",alone:!0},{default:t(()=>[e(p,{size:"small",placeholder:a(u)||"暂无",disabled:!0},{prefix:t(()=>[e(b,{component:a(i)},null,8,["component"])]),_:1},8,["placeholder"])]),_:1}),e(a(q),{name:"组件地址",alone:!0},{default:t(()=>[e(p,{size:"small",placeholder:a(o).request.requestUrl||"暂无",disabled:!0},{prefix:t(()=>[e(b,{component:a(d)},null,8,["component"])]),_:1},8,["placeholder"])]),_:1}),R("div",{class:"edit-text",onClick:G},[R("div",ce,[e(U,{type:"primary",secondary:""},{default:t(()=>[ie]),_:1})])])]),_:1}),e(a(q),{alone:!0},{name:t(()=>[_e,e(O,{trigger:"hover"},{trigger:t(()=>[e(b,{size:"21",depth:3},{default:t(()=>[e(a(c))]),_:1})]),default:t(()=>[pe]),_:1})]),default:t(()=>[e(U,{type:"primary",ghost:"",onClick:I},{icon:t(()=>[e(b,null,{default:t(()=>[e(a(d))]),_:1})]),default:t(()=>[me]),_:1})]),_:1}),e(a(se),{show:v.value&&!r.value,ajax:!0},null,8,["show"]),e(N,{load:r.value,repeat:3},null,8,["load"]),e(a(de),{modelShow:_.value,"onUpdate:modelShow":k[0]||(k[0]=V=>_.value=V),targetData:a(o),onSendHandle:I},null,8,["modelShow","targetData"])])}}});const ke=F(fe,[["__scopeId","data-v-feb01a36"]]);export{ke as default};
